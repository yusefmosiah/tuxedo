/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/_api/deprecation.py:26: UserWarning: Core Pydantic V1 functionality isn't compatible with Python 3.14 or greater.
  from pydantic.v1.fields import FieldInfo as FieldInfoV1
/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/pydantic/main.py:464: UserWarning: Pydantic serializer warnings:
  PydanticSerializationUnexpectedValue(Expected `ChatCompletionMessageFunctionToolCall` - serialized value may not be as expected [field_name='tool_calls', input_value={'id': 'toolu_bdrk_01NuEM... 'agent_list_accounts'}}, input_type=dict])
  PydanticSerializationUnexpectedValue(Expected `ChatCompletionMessageCustomToolCall` - serialized value may not be as expected [field_name='tool_calls', input_value={'id': 'toolu_bdrk_01NuEM... 'agent_list_accounts'}}, input_type=dict])
  return self.__pydantic_serializer__.to_python(
Traceback (most recent call last):
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_openai/chat_models/base.py", line 173, in _convert_dict_to_message
    tool_calls.append(parse_tool_call(raw_tool_call, return_id=True))
                      ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/output_parsers/openai_tools.py", line 60, in parse_tool_call
    raw_tool_call["function"]["arguments"], strict=strict
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'arguments'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/wiz/tuxedo/backend/vibewriter/test_choir_tools.py", line 18, in test_choir_tools
    result = agent.invoke(task, config={"recursion_limit": 20})
  File "/Users/wiz/tuxedo/backend/vibewriter/agent.py", line 157, in invoke
    return self.graph.invoke({"messages": messages}, config=config)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langgraph/pregel/main.py", line 3068, in invoke
    for chunk in self.stream(
                 ~~~~~~~~~~~^
        input,
        ^^^^^^
    ...<10 lines>...
        **kwargs,
        ^^^^^^^^^
    ):
    ^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langgraph/pregel/main.py", line 2643, in stream
    for _ in runner.tick(
             ~~~~~~~~~~~^
        [t for t in loop.tasks.values() if not t.writes],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        schedule_task=loop.accept_push,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langgraph/pregel/_runner.py", line 167, in tick
    run_with_retry(
    ~~~~~~~~~~~~~~^
        t,
        ^^
    ...<10 lines>...
        },
        ^^
    )
    ^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langgraph/pregel/_retry.py", line 42, in run_with_retry
    return task.proc.invoke(task.input, config)
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langgraph/_internal/_runnable.py", line 656, in invoke
    input = context.run(step.invoke, input, config, **kwargs)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langgraph/_internal/_runnable.py", line 400, in invoke
    ret = self.func(*args, **kwargs)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/agents/factory.py", line 1037, in model_node
    response = wrap_model_call_handler(request, _execute_model_sync)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/agents/factory.py", line 125, in normalized_single
    result = single_handler(request, handler)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/agents/middleware/todo.py", line 206, in wrap_model_call
    return handler(request)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/agents/factory.py", line 1007, in _execute_model_sync
    output = model_.invoke(messages)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/runnables/base.py", line 5534, in invoke
    return self.bound.invoke(
           ~~~~~~~~~~~~~~~~~^
        input,
        ^^^^^^
        self._merge_configs(config),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        **{**self.kwargs, **kwargs},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/language_models/chat_models.py", line 398, in invoke
    self.generate_prompt(
    ~~~~~~~~~~~~~~~~~~~~^
        [self._convert_input(input)],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
        **kwargs,
        ^^^^^^^^^
    ).generations[0][0],
    ^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/language_models/chat_models.py", line 1117, in generate_prompt
    return self.generate(prompt_messages, stop=stop, callbacks=callbacks, **kwargs)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/language_models/chat_models.py", line 927, in generate
    self._generate_with_cache(
    ~~~~~~~~~~~~~~~~~~~~~~~~~^
        m,
        ^^
    ...<2 lines>...
        **kwargs,
        ^^^^^^^^^
    )
    ^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/language_models/chat_models.py", line 1221, in _generate_with_cache
    result = self._generate(
        messages, stop=stop, run_manager=run_manager, **kwargs
    )
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_openai/chat_models/base.py", line 1306, in _generate
    return self._create_chat_result(response, generation_info)
           ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_openai/chat_models/base.py", line 1384, in _create_chat_result
    message = _convert_dict_to_message(res["message"])
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_openai/chat_models/base.py", line 176, in _convert_dict_to_message
    make_invalid_tool_call(raw_tool_call, str(e))
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/output_parsers/openai_tools.py", line 94, in make_invalid_tool_call
    args=raw_tool_call["function"]["arguments"],
         ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'arguments'
During task with name 'model' and id '640cba02-d6e8-5bd0-d5f4-9cc61398baa2'
Initializing Vibewriter Agent...
Task: List all my agent accounts.
Invoking agent...
Error during execution: 'arguments'
Cleaning up...
