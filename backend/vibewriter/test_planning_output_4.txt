/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/_api/deprecation.py:26: UserWarning: Core Pydantic V1 functionality isn't compatible with Python 3.14 or greater.
  from pydantic.v1.fields import FieldInfo as FieldInfoV1
Traceback (most recent call last):
  File "/Users/wiz/tuxedo/backend/vibewriter/test_planning.py", line 19, in test_planning
    result = agent.invoke(task, config={"recursion_limit": 50})
  File "/Users/wiz/tuxedo/backend/vibewriter/agent.py", line 53, in invoke
    return self.graph.invoke({"messages": messages}, config=config)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langgraph/pregel/main.py", line 3068, in invoke
    for chunk in self.stream(
                 ~~~~~~~~~~~^
        input,
        ^^^^^^
    ...<10 lines>...
        **kwargs,
        ^^^^^^^^^
    ):
    ^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langgraph/pregel/main.py", line 2643, in stream
    for _ in runner.tick(
             ~~~~~~~~~~~^
        [t for t in loop.tasks.values() if not t.writes],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        schedule_task=loop.accept_push,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ):
    ^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langgraph/pregel/_runner.py", line 167, in tick
    run_with_retry(
    ~~~~~~~~~~~~~~^
        t,
        ^^
    ...<10 lines>...
        },
        ^^
    )
    ^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langgraph/pregel/_retry.py", line 42, in run_with_retry
    return task.proc.invoke(task.input, config)
           ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langgraph/_internal/_runnable.py", line 656, in invoke
    input = context.run(step.invoke, input, config, **kwargs)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langgraph/_internal/_runnable.py", line 400, in invoke
    ret = self.func(*args, **kwargs)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/tools/tool_node.py", line 702, in _func
    outputs = list(executor.map(self._run_one, tool_calls, input_types, tool_runtimes))
  File "/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/concurrent/futures/_base.py", line 639, in result_iterator
    yield _result_or_cancel(fs.pop())
          ~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/concurrent/futures/_base.py", line 311, in _result_or_cancel
    return fut.result(timeout)
           ~~~~~~~~~~^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/concurrent/futures/_base.py", line 443, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/concurrent/futures/_base.py", line 395, in __get_result
    raise self._exception
  File "/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/concurrent/futures/thread.py", line 86, in run
    result = ctx.run(self.task)
  File "/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/concurrent/futures/thread.py", line 73, in run
    return fn(*args, **kwargs)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/runnables/config.py", line 546, in _wrapped_fn
    return contexts.pop().run(fn, *args)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/tools/tool_node.py", line 926, in _run_one
    content = _handle_tool_error(e, flag=self._handle_tool_errors)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/tools/tool_node.py", line 389, in _handle_tool_error
    content = flag(e)  # type: ignore [assignment, call-arg]
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/tools/tool_node.py", line 352, in _default_handle_tool_errors
    raise e
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/tools/tool_node.py", line 920, in _run_one
    return self._wrap_tool_call(tool_request, execute)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/deepagents/middleware/filesystem.py", line 900, in wrap_tool_call
    return handler(request)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/tools/tool_node.py", line 916, in execute
    return self._execute_tool_sync(req, input_type, config)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/tools/tool_node.py", line 860, in _execute_tool_sync
    content = _handle_tool_error(e, flag=self._handle_tool_errors)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/tools/tool_node.py", line 389, in _handle_tool_error
    content = flag(e)  # type: ignore [assignment, call-arg]
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/tools/tool_node.py", line 352, in _default_handle_tool_errors
    raise e
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain/tools/tool_node.py", line 815, in _execute_tool_sync
    response = tool.invoke(call_args, config)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/tools/base.py", line 605, in invoke
    return self.run(tool_input, **kwargs)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/tools/base.py", line 932, in run
    raise error_to_raise
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/tools/base.py", line 891, in run
    tool_args, tool_kwargs = self._to_args_and_kwargs(
                             ~~~~~~~~~~~~~~~~~~~~~~~~^
        tool_input, tool_call_id
        ^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/tools/base.py", line 794, in _to_args_and_kwargs
    tool_input = self._parse_input(tool_input, tool_call_id)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/langchain_core/tools/base.py", line 672, in _parse_input
    result = input_args.model_validate(tool_input)
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/pydantic/main.py", line 716, in model_validate
    return cls.__pydantic_validator__.validate_python(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/wiz/tuxedo/backend/venv/lib/python3.14/site-packages/pydantic/_internal/_mock_val_ser.py", line 100, in __getattr__
    raise PydanticUserError(self._error_message, code=self._code)
pydantic.errors.PydanticUserError: `write_file` is not fully defined; you should define `Required`, then call `write_file.model_rebuild()`.

For further information visit https://errors.pydantic.dev/2.12/u/class-not-fully-defined
During task with name 'tools' and id 'debdec75-ee4b-7924-5270-b819e46bb12a'
Initializing Vibewriter Agent...
Task: Create a plan to write a haiku about coding and save it to a file named 'haiku.txt'.
Invoking agent (this may take a minute)...
Error during execution: `write_file` is not fully defined; you should define `Required`, then call `write_file.model_rebuild()`.

For further information visit https://errors.pydantic.dev/2.12/u/class-not-fully-defined
Cleaning up...
